document.addEventListener("DOMContentLoaded",function(){AOS.init({duration:800,easing:"cubic-bezier(0.25, 0.1, 0.25, 1.0)",once:!1,mirror:!0,anchorPlacement:"center-bottom",offset:120,delay:100}),document.querySelectorAll(".rellax").length>0&&new Rellax(".rellax");let e=document.getElementById("header"),t=0,n=!1;window.addEventListener("scroll",function(){let l=window.pageYOffset||document.documentElement.scrollTop;n||(window.requestAnimationFrame(function(){l>50?e.classList.add("scrolled"):e.classList.remove("scrolled"),l>t&&l>200?e.classList.add("header-hidden"):e.classList.remove("header-hidden"),t=l<=0?0:l,n=!1}),n=!0)});let l=document.getElementById("logo-img"),a=document.getElementById("sorriso");gsap.set(a,{transformOrigin:"150px 190px"});let o=gsap.to(a,{scaleX:1.08,duration:1.5,repeat:-1,yoyo:!0,ease:"sine.inOut",paused:!0});window.addEventListener("scroll",function(){let e=window.scrollY;if(e<800){let t=Math.max(0,1-e/800);o.isActive()||o.play(),o.timeScale(.8+.4*t),gsap.to(a,{duration:.3,attr:{"stroke-width":16+4*t}})}else o.pause(),gsap.to(a,{duration:.5,attr:{"stroke-width":20}})}),l.addEventListener("mouseenter",function(){gsap.to(a,{duration:.4,scaleX:1.15,attr:{"stroke-width":24},ease:"back.out(1.7)"})}),l.addEventListener("mouseleave",function(){gsap.to(a,{duration:.6,scaleX:1,attr:{"stroke-width":20},ease:"elastic.out(1, 0.3)"})}),gsap.registerPlugin(ScrollTrigger),gsap.to(".hero-bg",{scrollTrigger:{trigger:".hero",start:"top top",end:"bottom top",scrub:1},clipPath:"polygon(0 0, 100% 0, 100% 100%, 0% 100%)",ease:"none"}),gsap.utils.toArray(".floating-element").forEach((e,t)=>{let n=parseFloat(e.getAttribute("data-speed"))||.1*t+.1;gsap.to(e,{scrollTrigger:{trigger:".hero",start:"top top",end:"bottom top",scrub:!0},y:`${-50*n}%`,x:`${20*n}%`,ease:"none"})}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let t=this.getAttribute("href"),n=document.querySelector(t);n&&window.scrollTo({top:n.offsetTop-70,behavior:"smooth"})})});let s=document.getElementById("menu-toggle"),i=document.getElementById("mini-menu-toggle"),r=document.getElementById("nav-links"),d=document.getElementById("menu-overlay"),c=document.getElementById("mini-header");function m(){s.classList.toggle("active"),i.classList.toggle("active"),r.classList.toggle("active"),d.classList.toggle("active"),document.body.classList.toggle("menu-open")}s.addEventListener("click",m),i.addEventListener("click",m),d.addEventListener("click",m),r.querySelectorAll("a").forEach(e=>{e.addEventListener("click",function(){r.classList.contains("active")&&m()})});let u=e.offsetHeight;window.addEventListener("scroll",function(){let n=window.pageYOffset||document.documentElement.scrollTop;n>u?(n<t?c.classList.add("visible"):r.classList.contains("active")||c.classList.remove("visible"),window.innerWidth<=768?(e.classList.add("scrolled"),n>t&&n>200?e.classList.add("header-hidden"):e.classList.remove("header-hidden")):(n>50?e.classList.add("scrolled"):e.classList.remove("scrolled"),n>t&&n>200?e.classList.add("header-hidden"):e.classList.remove("header-hidden"))):(c.classList.remove("visible"),e.classList.remove("scrolled"),e.classList.remove("header-hidden")),t=n<=0?0:n}),window.addEventListener("resize",function(){u=e.offsetHeight,window.innerWidth>768&&r.classList.contains("active")&&m()}),document.querySelectorAll(".nav-links a").forEach(e=>{e.addEventListener("click",()=>{document.getElementById("nav-links").classList.remove("active"),document.getElementById("menu-toggle").classList.remove("active"),document.getElementById("mini-menu-toggle")?.classList.remove("active"),document.getElementById("menu-overlay").classList.remove("active"),e.blur()})}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){setTimeout(()=>this.blur(),100)})});let g=document.getElementById("pdf-modal"),v=document.getElementById("pdf-modal-title"),$=document.getElementById("pdf-frame"),y=document.getElementById("pdf-modal-close");function f(){g.style.display="none",$.src="",document.body.style.overflow="",window.removeEventListener("wheel",p),window.removeEventListener("touchmove",p)}function p(e){return e.preventDefault(),!1}if(document.querySelectorAll("[data-modal-pdf]").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let t=this.getAttribute("data-modal-pdf"),n=this.getAttribute("data-modal-title")||"Documento";if((()=>{let e=navigator.userAgent||navigator.vendor||window.opera;return!!(/android/i.test(e)||/iPhone|iPod/i.test(e))||"MacIntel"===navigator.platform&&!!(navigator.maxTouchPoints>1)})())window.open(t,"_blank");else{var l,a;l=n,a=t,v.textContent=l,$.src=a+"#toolbar=0&embedded=true",g.style.display="block",document.body.style.overflow="hidden",window.addEventListener("wheel",p,{passive:!1}),window.addEventListener("touchmove",p,{passive:!1})}})}),y.addEventListener("click",f),g.addEventListener("click",function(e){e.target===g&&f()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&"block"===g.style.display&&f()}),function e(){let t=navigator.userAgent||"";return t.includes("FBAN")||t.includes("FBAV")||t.includes("Instagram")}()){console.warn("Rilevato browser interno Facebook/Instagram: attivo fallback");let h=document.getElementById("nav-links"),L=document.getElementById("menu-toggle"),E=document.getElementById("mini-menu-toggle"),_=document.getElementById("menu-overlay");_&&_.remove(),h&&h.classList.add("active"),L&&(L.classList.add("simulated"),L.classList.add("active")),E&&(E.classList.add("simulated"),E.classList.add("active"));let b=document.createElement("style");b.innerHTML=`
  @media (max-width: 768px) {
    .menu-toggle.simulated,
    .nav-links,
    .menu-overlay {
      display: none !important;
    }
  }
`,document.head.appendChild(b),document.querySelectorAll("[data-modal-pdf]").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let t=this.getAttribute("data-modal-pdf");t&&window.open(t,"_blank")})})}!function e(){gsap.to(".cta-container",{duration:1,delay:.3,opacity:1,y:0,ease:"power3.out",scrollTrigger:{trigger:".cta h2",start:"bottom 80%",toggleActions:"play none none none"}});let t=gsap.timeline({scrollTrigger:{trigger:".voto-wrapper",start:"top 80%",toggleActions:"restart none restart none"}});t.to("#x-line1",{attr:{x2:90,y2:90},duration:.6,ease:"power1.out"}),t.to("#x-line2",{attr:{x2:90,y2:10},duration:.6,ease:"power1.out"}),function e(t){let n=document.querySelector("#cognome-text");n&&(gsap.set(n,{opacity:0,y:20}),t.to(n,{opacity:1,y:0,duration:1,ease:"power2.out"}))}(t),t.to(".cta-disclaimer",{opacity:1,y:0,duration:.8,ease:"power2.out"})}()});